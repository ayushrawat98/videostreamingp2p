import{a as L,c as O,d as E,e as P}from"./chunk-KYWA7FUG.js";import{b as A,c as F}from"./chunk-XILJ65PU.js";import{b as w}from"./chunk-W4BGIUPB.js";import{e as T}from"./chunk-23WGBSG6.js";import"./chunk-FT2VNX5K.js";import{a as D}from"./chunk-XTE6BCLH.js";import"./chunk-LJKCP6BW.js";import{c as B,d as b,g as p,i as f}from"./chunk-6XXA7HXI.js";import{Ab as u,Eb as U,G as h,Hb as M,Jb as m,Rb as d,Sb as y,Ub as V,Wb as k,Ya as n,Za as c,a as _,ha as C,mb as l,ob as g,qa as I,ra as x,tb as s,y as S,yb as r,zb as a}from"./chunk-QI6MDMAJ.js";function N(i,e){i&1&&u(0,"mat-spinner")}function K(i,e){if(i&1){let t=U();r(0,"button",5),M("click",function(){I(t);let v=m(2);return x(v.subscribe())}),d(1),r(2,"mat-icon"),d(3,"add"),a()()}if(i&2){let t=m(2);n(),y(t.amISub?"Unsubscribe":"Subscribe")}}function R(i,e){if(i&1&&u(0,"app-videolist",3),i&2){let t=m(2);g("videoList",t.uploadedVideoList)("sortAllowed",!0)("latestFirst",!0)}}function J(i,e){i&1&&(r(0,"p",4),d(1,"No Videos! (\u2022\u02CB _ \u02CA\u2022)"),a())}function Y(i,e){if(i&1&&(r(0,"h1",1),d(1),l(2,K,4,1,"button",2),a(),l(3,R,1,3,"app-videolist",3)(4,J,2,0,"p",4),u(5,"br")(6,"br")),i&2){let t=m();n(),V("","@","",t.user.username," videos "),n(),s(t.loggedIn()?2:-1),n(),s(t.uploadedVideoList&&t.uploadedVideoList.length>0?3:-1),n(),s(t.uploadedVideoList&&t.uploadedVideoList.length==0?4:-1)}}function q(i,e){i&1&&(r(0,"p",0),d(1,"This user doesn't exist, young lady \u{1F64F}"),a())}var j=class i{constructor(e,t,o,v){this._userService=e;this.router=t;this._matSnackBar=o;this._authService=v}uploadedVideoList;userId;user;loggedIn;loading=!0;ngOnInit(){this.loggedIn=this._authService.loggedIn,this.router.paramMap.subscribe(e=>{this.userId=Number(e.get("UserId")),S([this._userService.getUserVideos(this.userId),this._userService.getUser(this.userId)]).subscribe({next:t=>{this.uploadedVideoList=t[0].map(o=>_({},o)),this.user=t[1],this.loggedIn()&&this.amISubscribed(),this.loading=!1}})})}getVideos(){this._userService.getUserVideos(this.userId).subscribe({next:e=>{this.uploadedVideoList=e.map(t=>_({},t))}})}subscribe(){this._userService.subscribeToUser({UserId:this.userId}).pipe(h(1e3)).subscribe({next:e=>{this._matSnackBar.open(e.message,"OK",{duration:2e3}),this.amISub=e.message=="Subscribed"},error:e=>{this._matSnackBar.open(e.error.message,"OK",{duration:2e3})}})}getUser(){this._userService.getUser(this.userId).subscribe(e=>{this.user=e,this.loggedIn()&&this.amISubscribed()},e=>{this._matSnackBar.open(e.error.message,"OK",{duration:2e3})})}amISub;amISubscribed(){this._userService.amISubscribed(this.user.id).subscribe({next:e=>{this.amISub=e.message=="yes"}})}static \u0275fac=function(t){return new(t||i)(c(D),c(T),c(O),c(A))};static \u0275cmp=C({type:i,selectors:[["app-user"]],standalone:!0,features:[k],decls:4,vars:3,consts:[[1,"center"],[2,"color","darkgray"],["mat-stroked-button","","color","accent",2,"color","#FFAD00"],[3,"videoList","sortAllowed","latestFirst"],[2,"text-align","center","color","darkgray"],["mat-stroked-button","","color","accent",2,"color","#FFAD00",3,"click"]],template:function(t,o){t&1&&(r(0,"div"),l(1,N,1,0,"mat-spinner")(2,Y,7,5)(3,q,2,0,"p",0),a()),t&2&&(g("@slideFromTop",void 0),n(),s(o.loading?1:-1),n(),s(!o.loading&&o.user?2:!o.loading&&!o.user?3:-1))},dependencies:[w,F,L,P,E],styles:["h1[_ngcontent-%COMP%]{text-align:center;padding:8px}mat-spinner[_ngcontent-%COMP%]{margin:auto;margin-top:40vh}"],data:{animation:[B("slideFromTop",[f(":enter",[p({opacity:0}),b("500ms ease-out",p({opacity:1}))]),f(":leave",[b("300ms ease-in",p({transform:"translateY(-100%)",opacity:0}))])])]}})};export{j as UserComponent};
